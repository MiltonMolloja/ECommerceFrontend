<div class="catalog-container">
  <!-- Breadcrumbs de navegación -->
  @if (currentCategorySlug()) {
    <div class="breadcrumb-section">
      <app-category-breadcrumb [categorySlug]="currentCategorySlug()" />
    </div>
  }

  <!-- Header con título -->
  <div class="catalog-header">
    @if (currentCategory()) {
      <h1>{{ currentCategory()!.name }}</h1>
      @if (currentCategory()!.description) {
        <p class="category-description">{{ currentCategory()!.description }}</p>
      }
    } @else {
      <h1>Catálogo de Productos</h1>
    }
  </div>

  <!-- Layout con sidebar y contenido -->
  <div class="catalog-layout">
    <!-- Sidebar con filtro de categorías -->
    <aside class="catalog-sidebar">
      <app-category-filter 
        [selectedCategorySlug]="currentCategorySlug()"
        (categorySelected)="onCategorySelected($event)" />
    </aside>

    <!-- Contenido principal -->
    <main class="catalog-main">
      @if (loading()) {
        <div class="loading-container">
          <mat-spinner></mat-spinner>
          <p>Cargando productos...</p>
        </div>
      } @else {
        <div class="products-grid">
          @for (product of products(); track trackByProductId($index, product)) {
        <mat-card class="product-card">
          <img
            mat-card-image
            [src]="'https://placehold.co/300x200?text=' + product.name"
            [alt]="product.name || 'Producto'"
            [title]="product.name || 'Producto'"
            [attr.aria-label]="product.name || 'Producto'"
            loading="lazy"
          />
          <mat-card-header>
            <mat-card-title>{{ product.name }}</mat-card-title>
            <mat-card-subtitle>ID: {{ product.productId }}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <p class="description">{{ product.description }}</p>
            <div class="price-container">
              <span class="price">${{ product.price }}</span>
              @if (product.stock && product.stock.stock === 0) {
                <mat-chip class="out-of-stock">Sin stock</mat-chip>
              } @else if (product.stock) {
                <mat-chip class="in-stock">Stock: {{ product.stock.stock }}</mat-chip>
              }
            </div>
          </mat-card-content>
          <mat-card-actions>
            <button
              mat-raised-button
              color="primary"
              [disabled]="product.stock && product.stock.stock === 0"
              (click)="addToCart(product)"
            >
              <mat-icon>add_shopping_cart</mat-icon>
              Agregar
            </button>
            <button mat-button color="accent">
              <mat-icon>favorite_border</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
          } @empty {
            <div class="empty-state">
              <mat-icon>inventory_2</mat-icon>
              <p>No hay productos disponibles</p>
            </div>
          }
        </div>
      }
    </main>
  </div>
</div>
