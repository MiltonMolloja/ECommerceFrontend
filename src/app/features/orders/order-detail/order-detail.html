@if (loading()) {
  <div class="loading-spinner">
    <mat-spinner></mat-spinner>
  </div>
} @else if (order()) {
  <div class="order-detail-container">
    <h1 class="order-number">{{ order()!.orderNumber }}</h1>
    <p class="subtitle">Información de la orden de compra</p>

    <div class="order-info">
      <div class="info-item">
        <span class="label">Cliente:</span>
        <span class="value">{{ order()!.client?.name || 'Client ' + order()!.clientId }}</span>
      </div>
      <div class="info-item">
        <span class="label">Método de pago:</span>
        <span class="value">{{ getPaymentTypeLabel(order()!.paymentType) }}</span>
      </div>
      <div class="info-item">
        <span class="label">Estado:</span>
        <span class="value">{{ getStatusLabel(order()!.status) }}</span>
      </div>
    </div>

    <div class="items-table-container">
      <table mat-table [dataSource]="order()!.items" class="items-table">
        <!-- Item Column -->
        <ng-container matColumnDef="item">
          <th mat-header-cell *matHeaderCellDef>Item</th>
          <td mat-cell *matCellDef="let item">
            {{ item.product?.name || 'Product ' + item.productId }}
          </td>
        </ng-container>

        <!-- Price Column -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef>Precio</th>
          <td mat-cell *matCellDef="let item">{{ item.unitPrice | number: '1.2-2' }}</td>
        </ng-container>

        <!-- Quantity Column -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>Cantidad</th>
          <td mat-cell *matCellDef="let item">{{ item.quantity }}</td>
        </ng-container>

        <!-- Total Column -->
        <ng-container matColumnDef="total">
          <th mat-header-cell *matHeaderCellDef>Total</th>
          <td mat-cell *matCellDef="let item">{{ item.total | number: '1.2-2' }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="total-section">
        <span class="total-value">{{ order()!.total | number: '1.2-2' }}</span>
      </div>
    </div>
  </div>
} @else {
  <div class="error-message">
    <p>No se pudo cargar la orden</p>
  </div>
}
